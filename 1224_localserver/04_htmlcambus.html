<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Canvas</title>
</head>
<body>
    <!-- canvasは幅と高さを指定する-->
    <canvas id="stage" width="500" height="500"></canvas>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> <!--jquery-->
    <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
    <!-- createjs -->

    <script>
        //DOMの読み込み
        $(function(){
            //canvasの取得
            var stage = new createjs.Stage('stage');

            //------------図形(丸)の描画--------------------|
            var circle = new createjs.Shape();

            circle.graphics.beginFill('#00FF00').drawCircle(0,0,40);//beginFillで塗り始める　変数circleに円を作成
            stage.addChild(circle); //ステージにcircleを作成、配置
            circle.x = 50;
            circle.y = 50;

            //トゥイーンアニメーション  getの中にどの要素を動かしたいのかを指定
            //どこに何秒で行けということを指定 連続して指定することも可能
            createjs.Tween.get(circle)
            .to({x:400,y:400},1000)
            .to({x:400,y:50},200)
            .wait(500) //止まる時間を指定可能
            .to({x:400,y:50,scaleX:2,scaleY:2,alpha:0.3},200) //座標以外も指定可能
            .to({x:400,y:400,scaleX:2},200,createjs.Ease.cubicIn) //イージングも利用可能。cubicInの他に、bounceOut,breakOutなど
            .call(nextAnime); //アニメーションを完了し、次のアニメーションへ

            function nextAnime(){ //次のアニメへ
                console.log('next animation');
                circle.scaleX= 1;
                circle.scaleY= 1;
            }


            //--------------/図形(星)の描画-----------------|
            var star = new createjs.Shape();

            star.graphics.beginFill('#FF0000').drawPolyStar(0,0,40,5,0.6,-90);//(x,y,山の半径,頂点の数、谷の深さ、スタートの角度)
            stage.addChild(star);
            star.x = stage.canvas.width/2;
            star.y = stage.canvas.height/2;

            //-------------------長方形--------------------------|
            var rect = new createjs.Shape();

            rect.graphics.beginFill('#0000FF').drawRect(0,0,50,50);
            stage.addChild(rect);
            rect.x = 400;
            rect.y = 0;
            rect.alpha = 0.5; //透明
            //rect.visible = false; //非表示


            //------------------
            createjs.Ticker.addEventListener('tick',tick);
            // requestAnimationFrameの実行：ブラウザのタブを移動した時にアニメーションをオフにする→メモリの削減に！
            createjs.Ticker.timingMode = createjs.Ticker.RAF_SYNCHED;

            //繰り返し読み込む箇所　プロセッシングでいうdraw
            function tick(){

                //-------- 円の挙動---------------|
                //circle.x += 5;
                //if(circle.x > stage.canvas.width){
                //    circle.x = 0;
                //}

                //-------- 星の挙動---------------|
                star.rotation += 5;
                if(star.rotation >=360){
                    star.rotation = 0;
                }

                //-------- ■の挙動---------------|
                rect.y += 5;
                if(rect.y > stage.canvas.height){
                    rect.y = 0;
                }

                stage.update();//描画の更新
            }
        });
    </script>
</body>
</html>
